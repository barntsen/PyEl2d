/*  Translated by epsc  version today */
#include <stddef.h>
typedef struct { float r; float i;} complex; 
typedef struct nctempfloat1 { int d[1]; float *a;} nctempfloat1; 
typedef struct nctempint1 { int d[1]; int *a;} nctempint1; 
typedef struct nctempchar1 { int d[1]; char *a;} nctempchar1; 
typedef struct nctempcomplex1 { int d[1]; complex *a;} nctempcomplex1; 
typedef struct nctempfloat2 { int d[2]; float *a;} nctempfloat2; 
typedef struct nctempint2 { int d[2]; int *a;} nctempint2; 
typedef struct nctempchar2 { int d[2]; char *a;} nctempchar2; 
typedef struct nctempcomplex2 { int d[2]; complex *a;} nctempcomplex2; 
typedef struct nctempfloat3 { int d[3]; float *a;} nctempfloat3; 
typedef struct nctempint3 { int d[3]; int *a;} nctempint3; 
typedef struct nctempchar3 { int d[3]; char *a;} nctempchar3; 
typedef struct nctempcomplex3 { int d[3]; complex *a;} nctempcomplex3; 
typedef struct nctempfloat4 { int d[4]; float *a;} nctempfloat4; 
typedef struct nctempint4 { int d[4]; int *a;} nctempint4; 
typedef struct nctempchar4 { int d[4]; char *a;} nctempchar4; 
typedef struct nctempcomplex4 { int d[4]; complex *a;} nctempcomplex4; 
#include <stdlib.h>
#include <string.h>
void *RunMalloc(int n); 
int RunFree(void *n); 
int LibeArrayex (int line,nctempchar1 *name,int ival,int index,int bound);
int LibeClearerr ();
int LibeGeterrno ();
nctempchar1* LibeGeterrstr ();
struct MainArg {nctempchar1 *arg;
};
typedef struct nctempMainArg1 {int d[1]; struct MainArg *a; } nctempMainArg1;
struct nctempMainArg2 {int d[2]; struct MainArg *a; } ;
struct nctempMainArg3 {int d[3]; struct MainArg *a; } ;
struct nctempMainArg4 {int d[4]; struct MainArg *a; } ;
int Main (struct nctempMainArg1 *MainArgs);
int LibeInit ();
int LibeDelete ();
int LibeExit ();
nctempchar1* LibeGetenv (nctempchar1 *name);
int LibeOpen (nctempchar1 *name,nctempchar1 *mode);
int LibeClose (int fp);
int LibeGetc (int fp);
int LibeUngetc (int fp);
int LibeGetw (int fp,nctempchar1 *text);
int LibePs (nctempchar1 *s);
int LibePi (int n);
int LibePf (float r);
int LibePutf (int fp,float r,nctempchar1 *form);
int LibePutc (int fp,int c);
int LibePuts (int fp,nctempchar1 *s);
int LibePuti (int fp,int ival);
int LibeRead (int fp,int n,nctempchar1 *array);
int LibeWrite (int fp,int n,nctempchar1 *array);
int LibeSeek (int fp,int pos,int flag);
int LibeFlush (int fp);
int LibeStrlen (nctempchar1 *s);
int LibeStrcmp (nctempchar1 *s,nctempchar1 *t);
int LibeStrev (nctempchar1 *s);
nctempchar1* LibeStrsave (nctempchar1 *s);
int LibeStrcpy (nctempchar1 *s,nctempchar1 *t);
int LibeStrcat (nctempchar1 *s,nctempchar1 *t);
nctempchar1* LibeStradd (nctempchar1 *t,nctempchar1 *s);
int LibeIsalpha (int c);
int LibeIsdigit (int c);
int LibeIsalnum (int c);
int LibeAtoi (nctempchar1 *s);
int LibeItoa (int n,nctempchar1 *s);
int LibeItoh (int n,nctempchar1 *s);
float LibeAtof (nctempchar1 *s);
int LibeFtoa (float f,nctempchar1 *fmt,nctempchar1 *s);
float LibeMach (int flag);
float LibeFabs (float x);
float LibeFscale2 (float x,int n);
float LibeGetfman2 (float x);
int LibeGetfexp2 (float x);
float LibeFscale (float x,int n);
int LibeGetfman (float f,int maxdig);
float LibeGetffman (float f);
int LibeGetmaxdig (float f);
int LibeGetfexp (float f);
float LibeClock ();
int LibeSetnb (int n);
int LibeSetnt (int n);
int LibeGetnb ();
int LibeGetnt ();
int LibeMod (int n,int r);
float LibeSqrt (float x);
float LibeLn (float x);
float LibeExp (float x);
float LibeSin (float x);
float LibeCos (float x);
float LibeTan (float x);
float LibeArcsin (float x);
float LibeArccos (float x);
float LibeArctan (float x);
float LibePow (float base,float exponent);
int LibeSystem (nctempchar1 *cmd);
struct model {int Nx;
int Ny;
int Nb;
float W0;
nctempfloat2 *Qlx;
nctempfloat2 *Qly;
nctempfloat2 *Qmx;
nctempfloat2 *Qmy;
nctempfloat2 *Qpx;
nctempfloat2 *Qpy;
nctempfloat2 *Qsx;
nctempfloat2 *Qsy;
nctempfloat2 *Lambda;
nctempfloat2 *Mu;
nctempfloat2 *Dlambdax;
nctempfloat2 *Dlambday;
nctempfloat2 *Dmux;
nctempfloat2 *Dmuy;
nctempfloat2 *Drhopx;
nctempfloat2 *Drhopy;
nctempfloat2 *Drhosx;
nctempfloat2 *Drhosy;
nctempfloat2 *Rho;
nctempfloat2 *Alpha1x;
nctempfloat2 *Alpha1y;
nctempfloat2 *Alpha2x;
nctempfloat2 *Alpha2y;
nctempfloat2 *Beta1x;
nctempfloat2 *Beta2x;
nctempfloat2 *Beta1y;
nctempfloat2 *Beta2y;
nctempfloat2 *Eta1x;
nctempfloat2 *Eta1y;
nctempfloat2 *Eta2x;
nctempfloat2 *Eta2y;
nctempfloat2 *Nu1x;
nctempfloat2 *Nu1y;
nctempfloat2 *Nu2x;
nctempfloat2 *Nu2y;
nctempfloat1 *dx;
nctempfloat1 *dy;
nctempfloat1 *dx1;
nctempfloat1 *dy1;
nctempfloat1 *dx2;
nctempfloat1 *dy2;
float Dx;
float Dt;
};
typedef struct nctempmodel1 {int d[1]; struct model *a; } nctempmodel1;
struct nctempmodel2 {int d[2]; struct model *a; } ;
struct nctempmodel3 {int d[3]; struct model *a; } ;
struct nctempmodel4 {int d[4]; struct model *a; } ;
struct model* ModelNew (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb,int Rheol);
float ModelStability (struct model* Model);
struct model* Modelsls (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb);
int Modelslscoeffs (nctempfloat2 *Qx,nctempfloat2 *Qy,nctempfloat2 *modx,nctempfloat2 *mody,nctempfloat2 *coeff1x,nctempfloat2 *coeff1y,nctempfloat2 *coeff2x,nctempfloat2 *coeff2y,struct model* Model);
int Modeld (nctempfloat1 *d,float dx,int nb);
int Modeld (nctempfloat1 *d,float dx,int nb)
{
int i;
int n;
int nctemp5=d->d[0];n =nctemp5;
i =0;
int nctemp13 = (i < n);
while(nctemp13){
{
int nctemp20=i;
d->a[nctemp20] =1.0;
}
int nctemp31 = i + 1;
i =nctemp31;
int nctemp32 = (i < n);
nctemp13=nctemp32;
}
i =0;
int nctemp40 = (i < nb);
while(nctemp40){
{
int nctemp47=i;
int nctemp53=i;
float nctemp68=(float)(i);
float nctemp72 = nctemp68 * dx;
float nctemp77=(float)(nb);
float nctemp81 = nctemp77 * dx;
float nctemp82 = nctemp72 / nctemp81;
float nctemp87=(float)(i);
float nctemp91 = nctemp87 * dx;
float nctemp92 = nctemp82 * nctemp91;
float nctemp97=(float)(nb);
float nctemp101 = nctemp97 * dx;
float nctemp102 = nctemp92 / nctemp101;
float nctemp103 = d->a[nctemp53] * nctemp102;
d->a[nctemp47] =nctemp103;
}
int nctemp112 = i + 1;
i =nctemp112;
int nctemp113 = (i < nb);
nctemp40=nctemp113;
}
int nctemp128 = n - 1;
int nctemp130 = nctemp128 - nb;
i =nctemp130;
int nctemp131 = (i < n);
while(nctemp131){
{
int nctemp138=i;
int nctemp144=i;
int nctemp168 = n - 1;
int nctemp170 = nctemp168 - i;
float nctemp159=(float)(nctemp170);
float nctemp172 = nctemp159 * dx;
float nctemp177=(float)(nb);
float nctemp181 = nctemp177 * dx;
float nctemp182 = nctemp172 / nctemp181;
int nctemp196 = n - 1;
int nctemp198 = nctemp196 - i;
float nctemp187=(float)(nctemp198);
float nctemp200 = nctemp187 * dx;
float nctemp201 = nctemp182 * nctemp200;
float nctemp206=(float)(nb);
float nctemp210 = nctemp206 * dx;
float nctemp211 = nctemp201 / nctemp210;
float nctemp212 = d->a[nctemp144] * nctemp211;
d->a[nctemp138] =nctemp212;
}
int nctemp221 = i + 1;
i =nctemp221;
int nctemp222 = (i < n);
nctemp131=nctemp222;
}
return 1;
}
int Modelslscoeffs (nctempfloat2 *Qx,nctempfloat2 *Qy,nctempfloat2 *modx,nctempfloat2 *mody,nctempfloat2 *coeff1x,nctempfloat2 *coeff1y,nctempfloat2 *coeff2x,nctempfloat2 *coeff2y,struct model* Model)
{
int Nx;
int Ny;
float tau0;
float tauex;
float tauey;
float tausx;
float tausy;
nctempfloat1 *d1;
nctempfloat1 *d2;
float argx;
float argy;
int i;
int j;
Nx =Model->Nx;
Ny =Model->Ny;
int nctemp241=Nx;
nctempfloat1 *nctemp240;
nctemp240=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp240->d[0]=Nx;
nctemp240->a=(float *)RunMalloc(sizeof(float)*nctemp241);
d1=nctemp240;
int nctemp250=Ny;
nctempfloat1 *nctemp249;
nctemp249=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp249->d[0]=Ny;
nctemp249->a=(float *)RunMalloc(sizeof(float)*nctemp250);
d2=nctemp249;
nctempfloat1* nctemp254= d1;
float nctemp257= Model->Dx;
int nctemp259= Model->Nb;
int nctemp261=Modeld(nctemp254,nctemp257,nctemp259);
nctempfloat1* nctemp263= d2;
float nctemp266= Model->Dx;
int nctemp268= Model->Nb;
int nctemp270=Modeld(nctemp263,nctemp266,nctemp268);
Model->dx=d1;
Model->dy=d2;
j =0;
int nctemp287 = (j < Ny);
while(nctemp287){
{
i =0;
int nctemp295 = (i < Nx);
while(nctemp295){
{
float nctemp307 = 1.0 / Model->W0;
tau0 =nctemp307;
int nctemp319=i;
nctemp319=j*Qx->d[0]+nctemp319;
float nctemp322 = tau0 / Qx->a[nctemp319];
int nctemp334=i;
nctemp334=j*Qx->d[0]+nctemp334;
int nctemp338=i;
nctemp338=j*Qx->d[0]+nctemp338;
float nctemp341 = Qx->a[nctemp334] * Qx->a[nctemp338];
float nctemp343 = nctemp341 + 1.0;
float nctemp327= nctemp343;
float nctemp344=LibeSqrt(nctemp327);
float nctemp346 = nctemp344 + 1.0;
float nctemp347 = nctemp322 * nctemp346;
tauex =nctemp347;
int nctemp359=i;
nctemp359=j*Qx->d[0]+nctemp359;
float nctemp362 = tau0 / Qx->a[nctemp359];
int nctemp374=i;
nctemp374=j*Qx->d[0]+nctemp374;
int nctemp378=i;
nctemp378=j*Qx->d[0]+nctemp378;
float nctemp381 = Qx->a[nctemp374] * Qx->a[nctemp378];
float nctemp383 = nctemp381 + 1.0;
float nctemp367= nctemp383;
float nctemp384=LibeSqrt(nctemp367);
float nctemp386 = nctemp384 - 1.0;
float nctemp387 = nctemp362 * nctemp386;
tausx =nctemp387;
int nctemp399=i;
nctemp399=j*Qy->d[0]+nctemp399;
float nctemp402 = tau0 / Qy->a[nctemp399];
int nctemp414=i;
nctemp414=j*Qy->d[0]+nctemp414;
int nctemp418=i;
nctemp418=j*Qy->d[0]+nctemp418;
float nctemp421 = Qy->a[nctemp414] * Qy->a[nctemp418];
float nctemp423 = nctemp421 + 1.0;
float nctemp407= nctemp423;
float nctemp424=LibeSqrt(nctemp407);
float nctemp426 = nctemp424 + 1.0;
float nctemp427 = nctemp402 * nctemp426;
tauey =nctemp427;
int nctemp439=i;
nctemp439=j*Qy->d[0]+nctemp439;
float nctemp442 = tau0 / Qy->a[nctemp439];
int nctemp454=i;
nctemp454=j*Qy->d[0]+nctemp454;
int nctemp458=i;
nctemp458=j*Qy->d[0]+nctemp458;
float nctemp461 = Qy->a[nctemp454] * Qy->a[nctemp458];
float nctemp463 = nctemp461 + 1.0;
float nctemp447= nctemp463;
float nctemp464=LibeSqrt(nctemp447);
float nctemp466 = nctemp464 - 1.0;
float nctemp467 = nctemp442 * nctemp466;
tausy =nctemp467;
float nctemp476 = 1.0 / tauex;
tauex =nctemp476;
float nctemp485 = 1.0 / tauey;
tauey =nctemp485;
float nctemp494 = 1.0 / tausx;
tausx =nctemp494;
float nctemp503 = 1.0 / tausy;
tausy =nctemp503;
int nctemp508=i;
argx =Model->dx->a[nctemp508];
int nctemp514=j;
argy =Model->dy->a[nctemp514];
int nctemp519=i;
nctemp519=j*coeff1x->d[0]+nctemp519;
float nctemp527= -argx;
float nctemp526= nctemp527;
float nctemp528=LibeExp(nctemp526);
float nctemp533= -Model->Dt;
float nctemp535 = nctemp533 * tausx;
float nctemp530= nctemp535;
float nctemp536=LibeExp(nctemp530);
float nctemp537 = nctemp528 * nctemp536;
coeff1x->a[nctemp519] =nctemp537;
int nctemp541=i;
nctemp541=j*coeff1y->d[0]+nctemp541;
float nctemp549= -argy;
float nctemp548= nctemp549;
float nctemp550=LibeExp(nctemp548);
float nctemp555= -Model->Dt;
float nctemp557 = nctemp555 * tausy;
float nctemp552= nctemp557;
float nctemp558=LibeExp(nctemp552);
float nctemp559 = nctemp550 * nctemp558;
coeff1y->a[nctemp541] =nctemp559;
int nctemp563=i;
nctemp563=j*coeff2x->d[0]+nctemp563;
float nctemp571 = Model->Dt * tauex;
coeff2x->a[nctemp563] =nctemp571;
int nctemp575=i;
nctemp575=j*coeff2y->d[0]+nctemp575;
float nctemp583 = Model->Dt * tauey;
coeff2y->a[nctemp575] =nctemp583;
int nctemp587=i;
nctemp587=j*modx->d[0]+nctemp587;
float nctemp598= -argx;
float nctemp597= nctemp598;
float nctemp599=LibeExp(nctemp597);
int nctemp601=i;
nctemp601=j*modx->d[0]+nctemp601;
float nctemp604 = nctemp599 * modx->a[nctemp601];
float nctemp614 = tausx / tauex;
float nctemp615 = 1.0 - nctemp614;
float nctemp616 = nctemp604 * nctemp615;
modx->a[nctemp587] =nctemp616;
int nctemp620=i;
nctemp620=j*mody->d[0]+nctemp620;
float nctemp631= -argy;
float nctemp630= nctemp631;
float nctemp632=LibeExp(nctemp630);
int nctemp634=i;
nctemp634=j*mody->d[0]+nctemp634;
float nctemp637 = nctemp632 * mody->a[nctemp634];
float nctemp647 = tausy / tauey;
float nctemp648 = 1.0 - nctemp647;
float nctemp649 = nctemp637 * nctemp648;
mody->a[nctemp620] =nctemp649;
}
int nctemp658 = i + 1;
i =nctemp658;
int nctemp659 = (i < Nx);
nctemp295=nctemp659;
}
}
int nctemp671 = j + 1;
j =nctemp671;
int nctemp672 = (j < Ny);
nctemp287=nctemp672;
}
RunFree(d1->a);
RunFree(d1);
RunFree(d2->a);
RunFree(d2);
return 1;
}
struct model* Modelsls (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb)
{
struct model* Model;
int Nx;
int Ny;
int i;
int j;
int fd;
int dsize;
nctempchar1 *data;
struct model *nctemp687=(struct model*)RunMalloc(sizeof(struct model));
Model =nctemp687;
Model->Dx =Dx;
Model->Dt =Dt;
int nctemp701=vp->d[0];Model->Nx =nctemp701;
int nctemp709=vp->d[1];Model->Ny =nctemp709;
Model->Nb =Nb;
Model->W0 =W0;
Nx =Model->Nx;
Ny =Model->Ny;
Model->Qlx=Qlx;
Model->Qly=Qly;
Model->Qmx=Qmx;
Model->Qmy=Qmy;
Model->Qpx=Qpx;
Model->Qpy=Qpy;
Model->Qsx=Qsx;
Model->Qsy=Qsy;
int nctemp783=Nx;
nctemp783=nctemp783*Ny;
nctempfloat2 *nctemp782;
nctemp782=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp782->d[0]=Nx;
nctemp782->d[1]=Ny;
nctemp782->a=(float *)RunMalloc(sizeof(float)*nctemp783);
Model->Rho=nctemp782;
int nctemp794=Nx;
nctemp794=nctemp794*Ny;
nctempfloat2 *nctemp793;
nctemp793=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp793->d[0]=Nx;
nctemp793->d[1]=Ny;
nctemp793->a=(float *)RunMalloc(sizeof(float)*nctemp794);
Model->Mu=nctemp793;
int nctemp805=Nx;
nctemp805=nctemp805*Ny;
nctempfloat2 *nctemp804;
nctemp804=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp804->d[0]=Nx;
nctemp804->d[1]=Ny;
nctemp804->a=(float *)RunMalloc(sizeof(float)*nctemp805);
Model->Lambda=nctemp804;
int nctemp816=Nx;
nctemp816=nctemp816*Ny;
nctempfloat2 *nctemp815;
nctemp815=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp815->d[0]=Nx;
nctemp815->d[1]=Ny;
nctemp815->a=(float *)RunMalloc(sizeof(float)*nctemp816);
Model->Dlambdax=nctemp815;
int nctemp827=Nx;
nctemp827=nctemp827*Ny;
nctempfloat2 *nctemp826;
nctemp826=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp826->d[0]=Nx;
nctemp826->d[1]=Ny;
nctemp826->a=(float *)RunMalloc(sizeof(float)*nctemp827);
Model->Dlambday=nctemp826;
int nctemp838=Nx;
nctemp838=nctemp838*Ny;
nctempfloat2 *nctemp837;
nctemp837=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp837->d[0]=Nx;
nctemp837->d[1]=Ny;
nctemp837->a=(float *)RunMalloc(sizeof(float)*nctemp838);
Model->Dmux=nctemp837;
int nctemp849=Nx;
nctemp849=nctemp849*Ny;
nctempfloat2 *nctemp848;
nctemp848=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp848->d[0]=Nx;
nctemp848->d[1]=Ny;
nctemp848->a=(float *)RunMalloc(sizeof(float)*nctemp849);
Model->Dmuy=nctemp848;
int nctemp860=Nx;
nctemp860=nctemp860*Ny;
nctempfloat2 *nctemp859;
nctemp859=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp859->d[0]=Nx;
nctemp859->d[1]=Ny;
nctemp859->a=(float *)RunMalloc(sizeof(float)*nctemp860);
Model->Drhopx=nctemp859;
int nctemp871=Nx;
nctemp871=nctemp871*Ny;
nctempfloat2 *nctemp870;
nctemp870=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp870->d[0]=Nx;
nctemp870->d[1]=Ny;
nctemp870->a=(float *)RunMalloc(sizeof(float)*nctemp871);
Model->Drhopy=nctemp870;
int nctemp882=Nx;
nctemp882=nctemp882*Ny;
nctempfloat2 *nctemp881;
nctemp881=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp881->d[0]=Nx;
nctemp881->d[1]=Ny;
nctemp881->a=(float *)RunMalloc(sizeof(float)*nctemp882);
Model->Drhosx=nctemp881;
int nctemp893=Nx;
nctemp893=nctemp893*Ny;
nctempfloat2 *nctemp892;
nctemp892=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp892->d[0]=Nx;
nctemp892->d[1]=Ny;
nctemp892->a=(float *)RunMalloc(sizeof(float)*nctemp893);
Model->Drhosy=nctemp892;
int nctemp904=Nx;
nctemp904=nctemp904*Ny;
nctempfloat2 *nctemp903;
nctemp903=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp903->d[0]=Nx;
nctemp903->d[1]=Ny;
nctemp903->a=(float *)RunMalloc(sizeof(float)*nctemp904);
Model->Alpha1x=nctemp903;
int nctemp915=Nx;
nctemp915=nctemp915*Ny;
nctempfloat2 *nctemp914;
nctemp914=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp914->d[0]=Nx;
nctemp914->d[1]=Ny;
nctemp914->a=(float *)RunMalloc(sizeof(float)*nctemp915);
Model->Alpha1y=nctemp914;
int nctemp926=Nx;
nctemp926=nctemp926*Ny;
nctempfloat2 *nctemp925;
nctemp925=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp925->d[0]=Nx;
nctemp925->d[1]=Ny;
nctemp925->a=(float *)RunMalloc(sizeof(float)*nctemp926);
Model->Alpha2x=nctemp925;
int nctemp937=Nx;
nctemp937=nctemp937*Ny;
nctempfloat2 *nctemp936;
nctemp936=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp936->d[0]=Nx;
nctemp936->d[1]=Ny;
nctemp936->a=(float *)RunMalloc(sizeof(float)*nctemp937);
Model->Alpha2y=nctemp936;
int nctemp948=Nx;
nctemp948=nctemp948*Ny;
nctempfloat2 *nctemp947;
nctemp947=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp947->d[0]=Nx;
nctemp947->d[1]=Ny;
nctemp947->a=(float *)RunMalloc(sizeof(float)*nctemp948);
Model->Beta1x=nctemp947;
int nctemp959=Nx;
nctemp959=nctemp959*Ny;
nctempfloat2 *nctemp958;
nctemp958=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp958->d[0]=Nx;
nctemp958->d[1]=Ny;
nctemp958->a=(float *)RunMalloc(sizeof(float)*nctemp959);
Model->Beta1y=nctemp958;
int nctemp970=Nx;
nctemp970=nctemp970*Ny;
nctempfloat2 *nctemp969;
nctemp969=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp969->d[0]=Nx;
nctemp969->d[1]=Ny;
nctemp969->a=(float *)RunMalloc(sizeof(float)*nctemp970);
Model->Beta2x=nctemp969;
int nctemp981=Nx;
nctemp981=nctemp981*Ny;
nctempfloat2 *nctemp980;
nctemp980=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp980->d[0]=Nx;
nctemp980->d[1]=Ny;
nctemp980->a=(float *)RunMalloc(sizeof(float)*nctemp981);
Model->Beta2y=nctemp980;
int nctemp992=Nx;
nctemp992=nctemp992*Ny;
nctempfloat2 *nctemp991;
nctemp991=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp991->d[0]=Nx;
nctemp991->d[1]=Ny;
nctemp991->a=(float *)RunMalloc(sizeof(float)*nctemp992);
Model->Eta1x=nctemp991;
int nctemp1003=Nx;
nctemp1003=nctemp1003*Ny;
nctempfloat2 *nctemp1002;
nctemp1002=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1002->d[0]=Nx;
nctemp1002->d[1]=Ny;
nctemp1002->a=(float *)RunMalloc(sizeof(float)*nctemp1003);
Model->Eta1y=nctemp1002;
int nctemp1014=Nx;
nctemp1014=nctemp1014*Ny;
nctempfloat2 *nctemp1013;
nctemp1013=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1013->d[0]=Nx;
nctemp1013->d[1]=Ny;
nctemp1013->a=(float *)RunMalloc(sizeof(float)*nctemp1014);
Model->Eta2x=nctemp1013;
int nctemp1025=Nx;
nctemp1025=nctemp1025*Ny;
nctempfloat2 *nctemp1024;
nctemp1024=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1024->d[0]=Nx;
nctemp1024->d[1]=Ny;
nctemp1024->a=(float *)RunMalloc(sizeof(float)*nctemp1025);
Model->Eta2y=nctemp1024;
int nctemp1036=Nx;
nctemp1036=nctemp1036*Ny;
nctempfloat2 *nctemp1035;
nctemp1035=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1035->d[0]=Nx;
nctemp1035->d[1]=Ny;
nctemp1035->a=(float *)RunMalloc(sizeof(float)*nctemp1036);
Model->Nu1x=nctemp1035;
int nctemp1047=Nx;
nctemp1047=nctemp1047*Ny;
nctempfloat2 *nctemp1046;
nctemp1046=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1046->d[0]=Nx;
nctemp1046->d[1]=Ny;
nctemp1046->a=(float *)RunMalloc(sizeof(float)*nctemp1047);
Model->Nu1y=nctemp1046;
int nctemp1058=Nx;
nctemp1058=nctemp1058*Ny;
nctempfloat2 *nctemp1057;
nctemp1057=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1057->d[0]=Nx;
nctemp1057->d[1]=Ny;
nctemp1057->a=(float *)RunMalloc(sizeof(float)*nctemp1058);
Model->Nu2x=nctemp1057;
int nctemp1069=Nx;
nctemp1069=nctemp1069*Ny;
nctempfloat2 *nctemp1068;
nctemp1068=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1068->d[0]=Nx;
nctemp1068->d[1]=Ny;
nctemp1068->a=(float *)RunMalloc(sizeof(float)*nctemp1069);
Model->Nu2y=nctemp1068;
j =0;
int nctemp1078 = (j < Ny);
while(nctemp1078){
{
i =0;
int nctemp1086 = (i < Nx);
while(nctemp1086){
{
int nctemp1093=i;
nctemp1093=j*Model->Rho->d[0]+nctemp1093;
int nctemp1101=i;
nctemp1101=j*rho->d[0]+nctemp1101;
float nctemp1104 = 1.0 / rho->a[nctemp1101];
Model->Rho->a[nctemp1093] =nctemp1104;
int nctemp1108=i;
nctemp1108=j*Model->Mu->d[0]+nctemp1108;
int nctemp1118=i;
nctemp1118=j*rho->d[0]+nctemp1118;
int nctemp1122=i;
nctemp1122=j*vs->d[0]+nctemp1122;
float nctemp1125 = rho->a[nctemp1118] * vs->a[nctemp1122];
int nctemp1127=i;
nctemp1127=j*vs->d[0]+nctemp1127;
float nctemp1130 = nctemp1125 * vs->a[nctemp1127];
Model->Mu->a[nctemp1108] =nctemp1130;
int nctemp1134=i;
nctemp1134=j*Model->Lambda->d[0]+nctemp1134;
int nctemp1141=i;
nctemp1141=j*rho->d[0]+nctemp1141;
int nctemp1151=i;
nctemp1151=j*vp->d[0]+nctemp1151;
int nctemp1155=i;
nctemp1155=j*vp->d[0]+nctemp1155;
float nctemp1158 = vp->a[nctemp1151] * vp->a[nctemp1155];
int nctemp1167=i;
nctemp1167=j*vs->d[0]+nctemp1167;
float nctemp1170 = 2.0 * vs->a[nctemp1167];
int nctemp1172=i;
nctemp1172=j*vs->d[0]+nctemp1172;
float nctemp1175 = nctemp1170 * vs->a[nctemp1172];
float nctemp1176 = nctemp1158 - nctemp1175;
float nctemp1177 = rho->a[nctemp1141] * nctemp1176;
Model->Lambda->a[nctemp1134] =nctemp1177;
int nctemp1181=i;
nctemp1181=j*Model->Alpha1x->d[0]+nctemp1181;
Model->Alpha1x->a[nctemp1181] =0.0;
int nctemp1188=i;
nctemp1188=j*Model->Alpha1y->d[0]+nctemp1188;
Model->Alpha1y->a[nctemp1188] =0.0;
int nctemp1195=i;
nctemp1195=j*Model->Alpha2x->d[0]+nctemp1195;
Model->Alpha2x->a[nctemp1195] =0.0;
int nctemp1202=i;
nctemp1202=j*Model->Alpha2y->d[0]+nctemp1202;
Model->Alpha2y->a[nctemp1202] =0.0;
int nctemp1209=i;
nctemp1209=j*Model->Beta1x->d[0]+nctemp1209;
Model->Beta1x->a[nctemp1209] =0.0;
int nctemp1216=i;
nctemp1216=j*Model->Beta1y->d[0]+nctemp1216;
Model->Beta1y->a[nctemp1216] =0.0;
int nctemp1223=i;
nctemp1223=j*Model->Beta2x->d[0]+nctemp1223;
Model->Beta2x->a[nctemp1223] =0.0;
int nctemp1230=i;
nctemp1230=j*Model->Beta2y->d[0]+nctemp1230;
Model->Beta2y->a[nctemp1230] =0.0;
int nctemp1237=i;
nctemp1237=j*Model->Eta1x->d[0]+nctemp1237;
Model->Eta1x->a[nctemp1237] =0.0;
int nctemp1244=i;
nctemp1244=j*Model->Eta1y->d[0]+nctemp1244;
Model->Eta1y->a[nctemp1244] =0.0;
int nctemp1251=i;
nctemp1251=j*Model->Eta2x->d[0]+nctemp1251;
Model->Eta2x->a[nctemp1251] =0.0;
int nctemp1258=i;
nctemp1258=j*Model->Eta2y->d[0]+nctemp1258;
Model->Eta2y->a[nctemp1258] =0.0;
int nctemp1265=i;
nctemp1265=j*Model->Dlambdax->d[0]+nctemp1265;
int nctemp1269=i;
nctemp1269=j*Model->Lambda->d[0]+nctemp1269;
Model->Dlambdax->a[nctemp1265] =Model->Lambda->a[nctemp1269];
int nctemp1275=i;
nctemp1275=j*Model->Dlambday->d[0]+nctemp1275;
int nctemp1279=i;
nctemp1279=j*Model->Lambda->d[0]+nctemp1279;
Model->Dlambday->a[nctemp1275] =Model->Lambda->a[nctemp1279];
int nctemp1285=i;
nctemp1285=j*Model->Dmux->d[0]+nctemp1285;
int nctemp1289=i;
nctemp1289=j*Model->Mu->d[0]+nctemp1289;
Model->Dmux->a[nctemp1285] =Model->Mu->a[nctemp1289];
int nctemp1295=i;
nctemp1295=j*Model->Dmuy->d[0]+nctemp1295;
int nctemp1299=i;
nctemp1299=j*Model->Mu->d[0]+nctemp1299;
Model->Dmuy->a[nctemp1295] =Model->Mu->a[nctemp1299];
int nctemp1305=i;
nctemp1305=j*Model->Drhopx->d[0]+nctemp1305;
int nctemp1309=i;
nctemp1309=j*Model->Rho->d[0]+nctemp1309;
Model->Drhopx->a[nctemp1305] =Model->Rho->a[nctemp1309];
int nctemp1315=i;
nctemp1315=j*Model->Drhopy->d[0]+nctemp1315;
int nctemp1319=i;
nctemp1319=j*Model->Rho->d[0]+nctemp1319;
Model->Drhopy->a[nctemp1315] =Model->Rho->a[nctemp1319];
int nctemp1325=i;
nctemp1325=j*Model->Drhosx->d[0]+nctemp1325;
int nctemp1329=i;
nctemp1329=j*Model->Rho->d[0]+nctemp1329;
Model->Drhosx->a[nctemp1325] =Model->Rho->a[nctemp1329];
int nctemp1335=i;
nctemp1335=j*Model->Drhosy->d[0]+nctemp1335;
int nctemp1339=i;
nctemp1339=j*Model->Rho->d[0]+nctemp1339;
Model->Drhosy->a[nctemp1335] =Model->Rho->a[nctemp1339];
}
int nctemp1350 = i + 1;
i =nctemp1350;
int nctemp1351 = (i < Nx);
nctemp1086=nctemp1351;
}
}
int nctemp1363 = j + 1;
j =nctemp1363;
int nctemp1364 = (j < Ny);
nctemp1078=nctemp1364;
}
nctempfloat2* nctemp1369= Model->Qlx;
nctempfloat2* nctemp1372= Model->Qly;
nctempfloat2* nctemp1375= Model->Dlambdax;
nctempfloat2* nctemp1378= Model->Dlambday;
nctempfloat2* nctemp1381= Model->Alpha1x;
nctempfloat2* nctemp1384= Model->Alpha1y;
nctempfloat2* nctemp1387= Model->Alpha2x;
nctempfloat2* nctemp1390= Model->Alpha2y;
struct model* nctemp1393= Model;
int nctemp1395=Modelslscoeffs(nctemp1369,nctemp1372,nctemp1375,nctemp1378,nctemp1381,nctemp1384,nctemp1387,nctemp1390,nctemp1393);
nctempfloat2* nctemp1397= Model->Qmx;
nctempfloat2* nctemp1400= Model->Qmy;
nctempfloat2* nctemp1403= Model->Dmux;
nctempfloat2* nctemp1406= Model->Dmuy;
nctempfloat2* nctemp1409= Model->Beta1x;
nctempfloat2* nctemp1412= Model->Beta1y;
nctempfloat2* nctemp1415= Model->Beta2x;
nctempfloat2* nctemp1418= Model->Beta2y;
struct model* nctemp1421= Model;
int nctemp1423=Modelslscoeffs(nctemp1397,nctemp1400,nctemp1403,nctemp1406,nctemp1409,nctemp1412,nctemp1415,nctemp1418,nctemp1421);
nctempfloat2* nctemp1425= Model->Qpx;
nctempfloat2* nctemp1428= Model->Qpy;
nctempfloat2* nctemp1431= Model->Drhopx;
nctempfloat2* nctemp1434= Model->Drhopy;
nctempfloat2* nctemp1437= Model->Eta1x;
nctempfloat2* nctemp1440= Model->Eta1y;
nctempfloat2* nctemp1443= Model->Eta2x;
nctempfloat2* nctemp1446= Model->Eta2y;
struct model* nctemp1449= Model;
int nctemp1451=Modelslscoeffs(nctemp1425,nctemp1428,nctemp1431,nctemp1434,nctemp1437,nctemp1440,nctemp1443,nctemp1446,nctemp1449);
nctempfloat2* nctemp1453= Model->Qsx;
nctempfloat2* nctemp1456= Model->Qsy;
nctempfloat2* nctemp1459= Model->Drhosx;
nctempfloat2* nctemp1462= Model->Drhosy;
nctempfloat2* nctemp1465= Model->Nu1x;
nctempfloat2* nctemp1468= Model->Nu1y;
nctempfloat2* nctemp1471= Model->Nu2x;
nctempfloat2* nctemp1474= Model->Nu2y;
struct model* nctemp1477= Model;
int nctemp1479=Modelslscoeffs(nctemp1453,nctemp1456,nctemp1459,nctemp1462,nctemp1465,nctemp1468,nctemp1471,nctemp1474,nctemp1477);
return Model;
}
struct model* ModelNew (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb,int Rheol)
{
struct model* m;
int nctemp1481 = (Rheol ==2);
if(nctemp1481)
{
nctempfloat2* nctemp1489= vp;
nctempfloat2* nctemp1492= vs;
nctempfloat2* nctemp1495= rho;
nctempfloat2* nctemp1498= Qlx;
nctempfloat2* nctemp1501= Qly;
nctempfloat2* nctemp1504= Qmx;
nctempfloat2* nctemp1507= Qmy;
nctempfloat2* nctemp1510= Qpx;
nctempfloat2* nctemp1513= Qpy;
nctempfloat2* nctemp1516= Qsx;
nctempfloat2* nctemp1519= Qsy;
float nctemp1522= Dx;
float nctemp1524= Dt;
float nctemp1526= W0;
int nctemp1528= Nb;
struct model* nctemp1530=Modelsls(nctemp1489,nctemp1492,nctemp1495,nctemp1498,nctemp1501,nctemp1504,nctemp1507,nctemp1510,nctemp1513,nctemp1516,nctemp1519,nctemp1522,nctemp1524,nctemp1526,nctemp1528);
m =nctemp1530;
}
else{
int nctemp1532= 4;
struct nctempchar1 *nctemp1536;
static struct nctempchar1 nctemp1537 = {{ 18}, (char*)"Unknown Q-model\n\0"};
nctemp1536=&nctemp1537;
nctempchar1* nctemp1534= nctemp1536;
int nctemp1538=LibePuts(nctemp1532,nctemp1534);
int nctemp1540= 4;
int nctemp1542=LibeFlush(nctemp1540);
int nctemp1544=LibeExit();
}
return m;
}
float ModelStability (struct model* Model)
{
int nx;
int ny;
int i;
int j;
float vp;
float stab;
nx =Model->Nx;
ny =Model->Ny;
j =0;
int nctemp1558 = (j < ny);
while(nctemp1558){
{
i =0;
int nctemp1566 = (i < nx);
while(nctemp1566){
{
int nctemp1581=i;
nctemp1581=j*Model->Lambda->d[0]+nctemp1581;
int nctemp1589=i;
nctemp1589=j*Model->Mu->d[0]+nctemp1589;
float nctemp1592 = 2.0 * Model->Mu->a[nctemp1589];
float nctemp1593 = Model->Lambda->a[nctemp1581] + nctemp1592;
int nctemp1595=i;
nctemp1595=j*Model->Rho->d[0]+nctemp1595;
float nctemp1598 = nctemp1593 / Model->Rho->a[nctemp1595];
float nctemp1574= nctemp1598;
float nctemp1599=LibeSqrt(nctemp1574);
vp =nctemp1599;
float nctemp1611 = vp * Model->Dt;
float nctemp1613 = nctemp1611 / Model->Dx;
stab =nctemp1613;
float nctemp1622= 2.0;
float nctemp1624=LibeSqrt(nctemp1622);
float nctemp1625 = 1.0 / nctemp1624;
int nctemp1614 = (stab > nctemp1625);
if(nctemp1614)
{
int nctemp1627= 4;
struct nctempchar1 *nctemp1631;
static struct nctempchar1 nctemp1632 = {{ 28}, (char*)"Stability index too large! \0"};
nctemp1631=&nctemp1632;
nctempchar1* nctemp1629= nctemp1631;
int nctemp1633=LibePuts(nctemp1627,nctemp1629);
int nctemp1635= 4;
float nctemp1637= stab;
struct nctempchar1 *nctemp1641;
static struct nctempchar1 nctemp1642 = {{ 2}, (char*)"g\0"};
nctemp1641=&nctemp1642;
nctempchar1* nctemp1639= nctemp1641;
int nctemp1643=LibePutf(nctemp1635,nctemp1637,nctemp1639);
int nctemp1645= 4;
struct nctempchar1 *nctemp1649;
static struct nctempchar1 nctemp1650 = {{ 3}, (char*)"\n\0"};
nctemp1649=&nctemp1650;
nctempchar1* nctemp1647= nctemp1649;
int nctemp1651=LibePuts(nctemp1645,nctemp1647);
int nctemp1653= 4;
struct nctempchar1 *nctemp1657;
static struct nctempchar1 nctemp1658 = {{ 7}, (char*)"vp: \n\0"};
nctemp1657=&nctemp1658;
nctempchar1* nctemp1655= nctemp1657;
int nctemp1659=LibePuts(nctemp1653,nctemp1655);
int nctemp1661= 4;
float nctemp1663= vp;
struct nctempchar1 *nctemp1667;
static struct nctempchar1 nctemp1668 = {{ 2}, (char*)"g\0"};
nctemp1667=&nctemp1668;
nctempchar1* nctemp1665= nctemp1667;
int nctemp1669=LibePutf(nctemp1661,nctemp1663,nctemp1665);
int nctemp1671= 4;
struct nctempchar1 *nctemp1675;
static struct nctempchar1 nctemp1676 = {{ 3}, (char*)"\n\0"};
nctemp1675=&nctemp1676;
nctempchar1* nctemp1673= nctemp1675;
int nctemp1677=LibePuts(nctemp1671,nctemp1673);
int nctemp1679= 4;
struct nctempchar1 *nctemp1683;
static struct nctempchar1 nctemp1684 = {{ 7}, (char*)"dt: \n\0"};
nctemp1683=&nctemp1684;
nctempchar1* nctemp1681= nctemp1683;
int nctemp1685=LibePuts(nctemp1679,nctemp1681);
int nctemp1687= 4;
float nctemp1689= Model->Dt;
struct nctempchar1 *nctemp1693;
static struct nctempchar1 nctemp1694 = {{ 2}, (char*)"g\0"};
nctemp1693=&nctemp1694;
nctempchar1* nctemp1691= nctemp1693;
int nctemp1695=LibePutf(nctemp1687,nctemp1689,nctemp1691);
int nctemp1697= 4;
struct nctempchar1 *nctemp1701;
static struct nctempchar1 nctemp1702 = {{ 3}, (char*)"\n\0"};
nctemp1701=&nctemp1702;
nctempchar1* nctemp1699= nctemp1701;
int nctemp1703=LibePuts(nctemp1697,nctemp1699);
int nctemp1705= 4;
struct nctempchar1 *nctemp1709;
static struct nctempchar1 nctemp1710 = {{ 7}, (char*)"dx: \n\0"};
nctemp1709=&nctemp1710;
nctempchar1* nctemp1707= nctemp1709;
int nctemp1711=LibePuts(nctemp1705,nctemp1707);
int nctemp1713= 4;
float nctemp1715= Model->Dx;
struct nctempchar1 *nctemp1719;
static struct nctempchar1 nctemp1720 = {{ 2}, (char*)"g\0"};
nctemp1719=&nctemp1720;
nctempchar1* nctemp1717= nctemp1719;
int nctemp1721=LibePutf(nctemp1713,nctemp1715,nctemp1717);
int nctemp1723= 4;
struct nctempchar1 *nctemp1727;
static struct nctempchar1 nctemp1728 = {{ 3}, (char*)"\n\0"};
nctemp1727=&nctemp1728;
nctempchar1* nctemp1725= nctemp1727;
int nctemp1729=LibePuts(nctemp1723,nctemp1725);
int nctemp1731= 4;
int nctemp1733=LibeFlush(nctemp1731);
}
}
int nctemp1742 = i + 1;
i =nctemp1742;
int nctemp1743 = (i < nx);
nctemp1566=nctemp1743;
}
}
int nctemp1755 = j + 1;
j =nctemp1755;
int nctemp1756 = (j < ny);
nctemp1558=nctemp1756;
}
return stab;
}
