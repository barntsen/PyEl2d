/*  Translated by epsc  version today */
#include <stddef.h>
typedef struct { float r; float i;} complex; 
typedef struct nctempfloat1 { int d[1]; float *a;} nctempfloat1; 
typedef struct nctempint1 { int d[1]; int *a;} nctempint1; 
typedef struct nctempchar1 { int d[1]; char *a;} nctempchar1; 
typedef struct nctempcomplex1 { int d[1]; complex *a;} nctempcomplex1; 
typedef struct nctempfloat2 { int d[2]; float *a;} nctempfloat2; 
typedef struct nctempint2 { int d[2]; int *a;} nctempint2; 
typedef struct nctempchar2 { int d[2]; char *a;} nctempchar2; 
typedef struct nctempcomplex2 { int d[2]; complex *a;} nctempcomplex2; 
typedef struct nctempfloat3 { int d[3]; float *a;} nctempfloat3; 
typedef struct nctempint3 { int d[3]; int *a;} nctempint3; 
typedef struct nctempchar3 { int d[3]; char *a;} nctempchar3; 
typedef struct nctempcomplex3 { int d[3]; complex *a;} nctempcomplex3; 
typedef struct nctempfloat4 { int d[4]; float *a;} nctempfloat4; 
typedef struct nctempint4 { int d[4]; int *a;} nctempint4; 
typedef struct nctempchar4 { int d[4]; char *a;} nctempchar4; 
typedef struct nctempcomplex4 { int d[4]; complex *a;} nctempcomplex4; 
#include <stdlib.h>
#include <string.h>
void *RunMalloc(int n); 
int RunFree(void *n); 
int LibeArrayex (int line,nctempchar1 *name,int ival,int index,int bound);
int LibeClearerr ();
int LibeGeterrno ();
nctempchar1* LibeGeterrstr ();
struct MainArg {nctempchar1 *arg;
};
typedef struct nctempMainArg1 {int d[1]; struct MainArg *a; } nctempMainArg1;
struct nctempMainArg2 {int d[2]; struct MainArg *a; } ;
struct nctempMainArg3 {int d[3]; struct MainArg *a; } ;
struct nctempMainArg4 {int d[4]; struct MainArg *a; } ;
int Main (struct nctempMainArg1 *MainArgs);
int LibeInit ();
int LibeDelete ();
int LibeExit ();
nctempchar1* LibeGetenv (nctempchar1 *name);
int LibeOpen (nctempchar1 *name,nctempchar1 *mode);
int LibeClose (int fp);
int LibeGetc (int fp);
int LibeUngetc (int fp);
int LibeGetw (int fp,nctempchar1 *text);
int LibePs (nctempchar1 *s);
int LibePi (int n);
int LibePf (float r);
int LibePutf (int fp,float r,nctempchar1 *form);
int LibePutc (int fp,int c);
int LibePuts (int fp,nctempchar1 *s);
int LibePuti (int fp,int ival);
int LibeRead (int fp,int n,nctempchar1 *array);
int LibeWrite (int fp,int n,nctempchar1 *array);
int LibeSeek (int fp,int pos,int flag);
int LibeFlush (int fp);
int LibeStrlen (nctempchar1 *s);
int LibeStrcmp (nctempchar1 *s,nctempchar1 *t);
int LibeStrev (nctempchar1 *s);
nctempchar1* LibeStrsave (nctempchar1 *s);
int LibeStrcpy (nctempchar1 *s,nctempchar1 *t);
int LibeStrcat (nctempchar1 *s,nctempchar1 *t);
nctempchar1* LibeStradd (nctempchar1 *t,nctempchar1 *s);
int LibeIsalpha (int c);
int LibeIsdigit (int c);
int LibeIsalnum (int c);
int LibeAtoi (nctempchar1 *s);
int LibeItoa (int n,nctempchar1 *s);
int LibeItoh (int n,nctempchar1 *s);
float LibeAtof (nctempchar1 *s);
int LibeFtoa (float f,nctempchar1 *fmt,nctempchar1 *s);
float LibeMach (int flag);
float LibeFabs (float x);
float LibeFscale2 (float x,int n);
float LibeGetfman2 (float x);
int LibeGetfexp2 (float x);
float LibeFscale (float x,int n);
int LibeGetfman (float f,int maxdig);
float LibeGetffman (float f);
int LibeGetmaxdig (float f);
int LibeGetfexp (float f);
float LibeClock ();
int LibeSetnb (int n);
int LibeSetnt (int n);
int LibeGetnb ();
int LibeGetnt ();
int LibeMod (int n,int r);
float LibeSqrt (float x);
float LibeLn (float x);
float LibeExp (float x);
float LibeSin (float x);
float LibeCos (float x);
float LibeTan (float x);
float LibeArcsin (float x);
float LibeArccos (float x);
float LibeArctan (float x);
float LibePow (float base,float exponent);
int LibeSystem (nctempchar1 *cmd);
struct model {int Nx;
int Ny;
int Nb;
float W0;
nctempfloat2 *Qlx;
nctempfloat2 *Qly;
nctempfloat2 *Qmx;
nctempfloat2 *Qmy;
nctempfloat2 *Qpx;
nctempfloat2 *Qpy;
nctempfloat2 *Qsx;
nctempfloat2 *Qsy;
nctempfloat2 *Lambda;
nctempfloat2 *Mu;
nctempfloat2 *Dlambdax;
nctempfloat2 *Dlambday;
nctempfloat2 *Dmux;
nctempfloat2 *Dmuy;
nctempfloat2 *Drhopx;
nctempfloat2 *Drhopy;
nctempfloat2 *Drhosx;
nctempfloat2 *Drhosy;
nctempfloat2 *Rho;
nctempfloat2 *Alpha1x;
nctempfloat2 *Alpha1y;
nctempfloat2 *Alpha2x;
nctempfloat2 *Alpha2y;
nctempfloat2 *Beta1x;
nctempfloat2 *Beta2x;
nctempfloat2 *Beta1y;
nctempfloat2 *Beta2y;
nctempfloat2 *Eta1x;
nctempfloat2 *Eta1y;
nctempfloat2 *Eta2x;
nctempfloat2 *Eta2y;
nctempfloat2 *Nu1x;
nctempfloat2 *Nu1y;
nctempfloat2 *Nu2x;
nctempfloat2 *Nu2y;
nctempfloat1 *dx;
nctempfloat1 *dy;
nctempfloat1 *dx1;
nctempfloat1 *dy1;
nctempfloat1 *dx2;
nctempfloat1 *dy2;
float Dx;
float Dt;
};
typedef struct nctempmodel1 {int d[1]; struct model *a; } nctempmodel1;
struct nctempmodel2 {int d[2]; struct model *a; } ;
struct nctempmodel3 {int d[3]; struct model *a; } ;
struct nctempmodel4 {int d[4]; struct model *a; } ;
struct model* ModelNew (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb,int Rheol);
float ModelStability (struct model* Model);
struct model* Modelsls (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb);
int Modelslscoeffs (nctempfloat2 *Qx,nctempfloat2 *Qy,nctempfloat2 *modx,nctempfloat2 *mody,nctempfloat2 *coeff1x,nctempfloat2 *coeff1y,nctempfloat2 *coeff2x,nctempfloat2 *coeff2y,struct model* Model);
int Modeld (nctempfloat1 *d,float dx,int nb);
int Modeld (nctempfloat1 *d,float dx,int nb)
{
int i;
int n;
int nctemp5=d->d[0];n =nctemp5;
i =0;
int nctemp13 = (i < n);
while(nctemp13){
{
int nctemp20=i;
d->a[nctemp20] =1.0;
}
int nctemp31 = i + 1;
i =nctemp31;
int nctemp32 = (i < n);
nctemp13=nctemp32;
}
i =0;
int nctemp40 = (i < nb);
while(nctemp40){
{
int nctemp47=i;
int nctemp53=i;
float nctemp68=(float)(i);
float nctemp72 = nctemp68 * dx;
float nctemp77=(float)(nb);
float nctemp81 = nctemp77 * dx;
float nctemp82 = nctemp72 / nctemp81;
float nctemp87=(float)(i);
float nctemp91 = nctemp87 * dx;
float nctemp92 = nctemp82 * nctemp91;
float nctemp97=(float)(nb);
float nctemp101 = nctemp97 * dx;
float nctemp102 = nctemp92 / nctemp101;
float nctemp103 = d->a[nctemp53] * nctemp102;
d->a[nctemp47] =nctemp103;
}
int nctemp112 = i + 1;
i =nctemp112;
int nctemp113 = (i < nb);
nctemp40=nctemp113;
}
int nctemp128 = n - 1;
int nctemp130 = nctemp128 - nb;
i =nctemp130;
int nctemp131 = (i < n);
while(nctemp131){
{
int nctemp138=i;
int nctemp144=i;
int nctemp168 = n - 1;
int nctemp170 = nctemp168 - i;
float nctemp159=(float)(nctemp170);
float nctemp172 = nctemp159 * dx;
float nctemp177=(float)(nb);
float nctemp181 = nctemp177 * dx;
float nctemp182 = nctemp172 / nctemp181;
int nctemp196 = n - 1;
int nctemp198 = nctemp196 - i;
float nctemp187=(float)(nctemp198);
float nctemp200 = nctemp187 * dx;
float nctemp201 = nctemp182 * nctemp200;
float nctemp206=(float)(nb);
float nctemp210 = nctemp206 * dx;
float nctemp211 = nctemp201 / nctemp210;
float nctemp212 = d->a[nctemp144] * nctemp211;
d->a[nctemp138] =nctemp212;
}
int nctemp221 = i + 1;
i =nctemp221;
int nctemp222 = (i < n);
nctemp131=nctemp222;
}
return 1;
}
int Modelslscoeffs (nctempfloat2 *Qx,nctempfloat2 *Qy,nctempfloat2 *modx,nctempfloat2 *mody,nctempfloat2 *coeff1x,nctempfloat2 *coeff1y,nctempfloat2 *coeff2x,nctempfloat2 *coeff2y,struct model* Model)
{
int Nx;
int Ny;
int i;
int j;
float tau0;
float tauex;
float tauey;
float tausx;
float tausy;
nctempfloat1 *d1;
nctempfloat1 *d2;
float argx;
float argy;
nctempfloat1 *taus;
nctempfloat1 *taue;
nctempchar1 *data;
int fd;
Nx =Model->Nx;
Ny =Model->Ny;
int nctemp241=Nx;
nctempfloat1 *nctemp240;
nctemp240=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp240->d[0]=Nx;
nctemp240->a=(float *)RunMalloc(sizeof(float)*nctemp241);
d1=nctemp240;
int nctemp250=Ny;
nctempfloat1 *nctemp249;
nctemp249=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp249->d[0]=Ny;
nctemp249->a=(float *)RunMalloc(sizeof(float)*nctemp250);
d2=nctemp249;
int nctemp259=Nx;
nctempfloat1 *nctemp258;
nctemp258=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp258->d[0]=Nx;
nctemp258->a=(float *)RunMalloc(sizeof(float)*nctemp259);
taus=nctemp258;
int nctemp268=Nx;
nctempfloat1 *nctemp267;
nctemp267=(nctempfloat1*)RunMalloc(sizeof(nctempfloat1));
nctemp267->d[0]=Nx;
nctemp267->a=(float *)RunMalloc(sizeof(float)*nctemp268);
taue=nctemp267;
nctempfloat1* nctemp272= d1;
float nctemp275= Model->Dx;
int nctemp277= Model->Nb;
int nctemp279=Modeld(nctemp272,nctemp275,nctemp277);
nctempfloat1* nctemp281= d2;
float nctemp284= Model->Dx;
int nctemp286= Model->Nb;
int nctemp288=Modeld(nctemp281,nctemp284,nctemp286);
Model->dx=d1;
Model->dy=d2;
j =0;
int nctemp305 = (j < Ny);
while(nctemp305){
{
i =0;
int nctemp313 = (i < Nx);
while(nctemp313){
{
float nctemp325 = 1.0 / Model->W0;
tau0 =nctemp325;
int nctemp337=i;
nctemp337=j*Qx->d[0]+nctemp337;
float nctemp340 = tau0 / Qx->a[nctemp337];
int nctemp352=i;
nctemp352=j*Qx->d[0]+nctemp352;
int nctemp356=i;
nctemp356=j*Qx->d[0]+nctemp356;
float nctemp359 = Qx->a[nctemp352] * Qx->a[nctemp356];
float nctemp361 = nctemp359 + 1.0;
float nctemp345= nctemp361;
float nctemp362=LibeSqrt(nctemp345);
float nctemp364 = nctemp362 + 1.0;
float nctemp365 = nctemp340 * nctemp364;
tauex =nctemp365;
int nctemp377=i;
nctemp377=j*Qx->d[0]+nctemp377;
float nctemp380 = tau0 / Qx->a[nctemp377];
int nctemp392=i;
nctemp392=j*Qx->d[0]+nctemp392;
int nctemp396=i;
nctemp396=j*Qx->d[0]+nctemp396;
float nctemp399 = Qx->a[nctemp392] * Qx->a[nctemp396];
float nctemp401 = nctemp399 + 1.0;
float nctemp385= nctemp401;
float nctemp402=LibeSqrt(nctemp385);
float nctemp404 = nctemp402 - 1.0;
float nctemp405 = nctemp380 * nctemp404;
tausx =nctemp405;
int nctemp417=i;
nctemp417=j*Qy->d[0]+nctemp417;
float nctemp420 = tau0 / Qy->a[nctemp417];
int nctemp432=i;
nctemp432=j*Qy->d[0]+nctemp432;
int nctemp436=i;
nctemp436=j*Qy->d[0]+nctemp436;
float nctemp439 = Qy->a[nctemp432] * Qy->a[nctemp436];
float nctemp441 = nctemp439 + 1.0;
float nctemp425= nctemp441;
float nctemp442=LibeSqrt(nctemp425);
float nctemp444 = nctemp442 + 1.0;
float nctemp445 = nctemp420 * nctemp444;
tauey =nctemp445;
int nctemp457=i;
nctemp457=j*Qy->d[0]+nctemp457;
float nctemp460 = tau0 / Qy->a[nctemp457];
int nctemp472=i;
nctemp472=j*Qy->d[0]+nctemp472;
int nctemp476=i;
nctemp476=j*Qy->d[0]+nctemp476;
float nctemp479 = Qy->a[nctemp472] * Qy->a[nctemp476];
float nctemp481 = nctemp479 + 1.0;
float nctemp465= nctemp481;
float nctemp482=LibeSqrt(nctemp465);
float nctemp484 = nctemp482 - 1.0;
float nctemp485 = nctemp460 * nctemp484;
tausy =nctemp485;
float nctemp494 = 1.0 / tauex;
tauex =nctemp494;
float nctemp503 = 1.0 / tauey;
tauey =nctemp503;
float nctemp512 = 1.0 / tausx;
tausx =nctemp512;
float nctemp521 = 1.0 / tausy;
tausy =nctemp521;
int nctemp526=i;
argx =Model->dx->a[nctemp526];
int nctemp532=j;
argy =Model->dy->a[nctemp532];
int nctemp537=i;
nctemp537=j*coeff1x->d[0]+nctemp537;
float nctemp545= -argx;
float nctemp544= nctemp545;
float nctemp546=LibeExp(nctemp544);
float nctemp551= -Model->Dt;
float nctemp553 = nctemp551 * tausx;
float nctemp548= nctemp553;
float nctemp554=LibeExp(nctemp548);
float nctemp555 = nctemp546 * nctemp554;
coeff1x->a[nctemp537] =nctemp555;
int nctemp559=i;
nctemp559=j*coeff1y->d[0]+nctemp559;
float nctemp567= -argy;
float nctemp566= nctemp567;
float nctemp568=LibeExp(nctemp566);
float nctemp573= -Model->Dt;
float nctemp575 = nctemp573 * tausy;
float nctemp570= nctemp575;
float nctemp576=LibeExp(nctemp570);
float nctemp577 = nctemp568 * nctemp576;
coeff1y->a[nctemp559] =nctemp577;
int nctemp581=i;
nctemp581=j*coeff2x->d[0]+nctemp581;
float nctemp589 = Model->Dt * tauex;
coeff2x->a[nctemp581] =nctemp589;
int nctemp593=i;
nctemp593=j*coeff2y->d[0]+nctemp593;
float nctemp601 = Model->Dt * tauey;
coeff2y->a[nctemp593] =nctemp601;
int nctemp605=i;
int nctemp608=i;
nctemp608=j*coeff2x->d[0]+nctemp608;
taus->a[nctemp605] =coeff2x->a[nctemp608];
int nctemp614=j;
int nctemp617=i;
nctemp617=j*coeff2y->d[0]+nctemp617;
taue->a[nctemp614] =coeff2y->a[nctemp617];
int nctemp623=i;
nctemp623=j*modx->d[0]+nctemp623;
float nctemp634= -argx;
float nctemp633= nctemp634;
float nctemp635=LibeExp(nctemp633);
int nctemp637=i;
nctemp637=j*modx->d[0]+nctemp637;
float nctemp640 = nctemp635 * modx->a[nctemp637];
float nctemp650 = tausx / tauex;
float nctemp651 = 1.0 - nctemp650;
float nctemp652 = nctemp640 * nctemp651;
modx->a[nctemp623] =nctemp652;
int nctemp656=i;
nctemp656=j*mody->d[0]+nctemp656;
float nctemp667= -argy;
float nctemp666= nctemp667;
float nctemp668=LibeExp(nctemp666);
int nctemp670=i;
nctemp670=j*mody->d[0]+nctemp670;
float nctemp673 = nctemp668 * mody->a[nctemp670];
float nctemp683 = tausy / tauey;
float nctemp684 = 1.0 - nctemp683;
float nctemp685 = nctemp673 * nctemp684;
mody->a[nctemp656] =nctemp685;
}
int nctemp694 = i + 1;
i =nctemp694;
int nctemp695 = (i < Nx);
nctemp313=nctemp695;
}
}
int nctemp707 = j + 1;
j =nctemp707;
int nctemp708 = (j < Ny);
nctemp305=nctemp708;
}
RunFree(d1->a);
RunFree(d1);
RunFree(d2->a);
RunFree(d2);
return 1;
}
struct model* Modelsls (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb)
{
struct model* Model;
int Nx;
int Ny;
int i;
int j;
int fd;
int dsize;
nctempchar1 *data;
struct model *nctemp723=(struct model*)RunMalloc(sizeof(struct model));
Model =nctemp723;
Model->Dx =Dx;
Model->Dt =Dt;
int nctemp737=vp->d[0];Model->Nx =nctemp737;
int nctemp745=vp->d[1];Model->Ny =nctemp745;
Model->Nb =Nb;
Model->W0 =W0;
Nx =Model->Nx;
Ny =Model->Ny;
Model->Qlx=Qlx;
Model->Qly=Qly;
Model->Qmx=Qlx;
Model->Qmy=Qly;
Model->Qpx=Qpx;
Model->Qpy=Qpy;
Model->Qsx=Qsx;
Model->Qsy=Qsy;
int nctemp819=Nx;
nctemp819=nctemp819*Ny;
nctempfloat2 *nctemp818;
nctemp818=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp818->d[0]=Nx;
nctemp818->d[1]=Ny;
nctemp818->a=(float *)RunMalloc(sizeof(float)*nctemp819);
Model->Rho=nctemp818;
int nctemp830=Nx;
nctemp830=nctemp830*Ny;
nctempfloat2 *nctemp829;
nctemp829=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp829->d[0]=Nx;
nctemp829->d[1]=Ny;
nctemp829->a=(float *)RunMalloc(sizeof(float)*nctemp830);
Model->Mu=nctemp829;
int nctemp841=Nx;
nctemp841=nctemp841*Ny;
nctempfloat2 *nctemp840;
nctemp840=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp840->d[0]=Nx;
nctemp840->d[1]=Ny;
nctemp840->a=(float *)RunMalloc(sizeof(float)*nctemp841);
Model->Lambda=nctemp840;
int nctemp852=Nx;
nctemp852=nctemp852*Ny;
nctempfloat2 *nctemp851;
nctemp851=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp851->d[0]=Nx;
nctemp851->d[1]=Ny;
nctemp851->a=(float *)RunMalloc(sizeof(float)*nctemp852);
Model->Dlambdax=nctemp851;
int nctemp863=Nx;
nctemp863=nctemp863*Ny;
nctempfloat2 *nctemp862;
nctemp862=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp862->d[0]=Nx;
nctemp862->d[1]=Ny;
nctemp862->a=(float *)RunMalloc(sizeof(float)*nctemp863);
Model->Dlambday=nctemp862;
int nctemp874=Nx;
nctemp874=nctemp874*Ny;
nctempfloat2 *nctemp873;
nctemp873=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp873->d[0]=Nx;
nctemp873->d[1]=Ny;
nctemp873->a=(float *)RunMalloc(sizeof(float)*nctemp874);
Model->Dmux=nctemp873;
int nctemp885=Nx;
nctemp885=nctemp885*Ny;
nctempfloat2 *nctemp884;
nctemp884=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp884->d[0]=Nx;
nctemp884->d[1]=Ny;
nctemp884->a=(float *)RunMalloc(sizeof(float)*nctemp885);
Model->Dmuy=nctemp884;
int nctemp896=Nx;
nctemp896=nctemp896*Ny;
nctempfloat2 *nctemp895;
nctemp895=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp895->d[0]=Nx;
nctemp895->d[1]=Ny;
nctemp895->a=(float *)RunMalloc(sizeof(float)*nctemp896);
Model->Drhopx=nctemp895;
int nctemp907=Nx;
nctemp907=nctemp907*Ny;
nctempfloat2 *nctemp906;
nctemp906=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp906->d[0]=Nx;
nctemp906->d[1]=Ny;
nctemp906->a=(float *)RunMalloc(sizeof(float)*nctemp907);
Model->Drhopy=nctemp906;
int nctemp918=Nx;
nctemp918=nctemp918*Ny;
nctempfloat2 *nctemp917;
nctemp917=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp917->d[0]=Nx;
nctemp917->d[1]=Ny;
nctemp917->a=(float *)RunMalloc(sizeof(float)*nctemp918);
Model->Drhosx=nctemp917;
int nctemp929=Nx;
nctemp929=nctemp929*Ny;
nctempfloat2 *nctemp928;
nctemp928=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp928->d[0]=Nx;
nctemp928->d[1]=Ny;
nctemp928->a=(float *)RunMalloc(sizeof(float)*nctemp929);
Model->Drhosy=nctemp928;
int nctemp940=Nx;
nctemp940=nctemp940*Ny;
nctempfloat2 *nctemp939;
nctemp939=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp939->d[0]=Nx;
nctemp939->d[1]=Ny;
nctemp939->a=(float *)RunMalloc(sizeof(float)*nctemp940);
Model->Alpha1x=nctemp939;
int nctemp951=Nx;
nctemp951=nctemp951*Ny;
nctempfloat2 *nctemp950;
nctemp950=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp950->d[0]=Nx;
nctemp950->d[1]=Ny;
nctemp950->a=(float *)RunMalloc(sizeof(float)*nctemp951);
Model->Alpha1y=nctemp950;
int nctemp962=Nx;
nctemp962=nctemp962*Ny;
nctempfloat2 *nctemp961;
nctemp961=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp961->d[0]=Nx;
nctemp961->d[1]=Ny;
nctemp961->a=(float *)RunMalloc(sizeof(float)*nctemp962);
Model->Alpha2x=nctemp961;
int nctemp973=Nx;
nctemp973=nctemp973*Ny;
nctempfloat2 *nctemp972;
nctemp972=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp972->d[0]=Nx;
nctemp972->d[1]=Ny;
nctemp972->a=(float *)RunMalloc(sizeof(float)*nctemp973);
Model->Alpha2y=nctemp972;
int nctemp984=Nx;
nctemp984=nctemp984*Ny;
nctempfloat2 *nctemp983;
nctemp983=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp983->d[0]=Nx;
nctemp983->d[1]=Ny;
nctemp983->a=(float *)RunMalloc(sizeof(float)*nctemp984);
Model->Beta1x=nctemp983;
int nctemp995=Nx;
nctemp995=nctemp995*Ny;
nctempfloat2 *nctemp994;
nctemp994=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp994->d[0]=Nx;
nctemp994->d[1]=Ny;
nctemp994->a=(float *)RunMalloc(sizeof(float)*nctemp995);
Model->Beta1y=nctemp994;
int nctemp1006=Nx;
nctemp1006=nctemp1006*Ny;
nctempfloat2 *nctemp1005;
nctemp1005=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1005->d[0]=Nx;
nctemp1005->d[1]=Ny;
nctemp1005->a=(float *)RunMalloc(sizeof(float)*nctemp1006);
Model->Beta2x=nctemp1005;
int nctemp1017=Nx;
nctemp1017=nctemp1017*Ny;
nctempfloat2 *nctemp1016;
nctemp1016=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1016->d[0]=Nx;
nctemp1016->d[1]=Ny;
nctemp1016->a=(float *)RunMalloc(sizeof(float)*nctemp1017);
Model->Beta2y=nctemp1016;
int nctemp1028=Nx;
nctemp1028=nctemp1028*Ny;
nctempfloat2 *nctemp1027;
nctemp1027=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1027->d[0]=Nx;
nctemp1027->d[1]=Ny;
nctemp1027->a=(float *)RunMalloc(sizeof(float)*nctemp1028);
Model->Eta1x=nctemp1027;
int nctemp1039=Nx;
nctemp1039=nctemp1039*Ny;
nctempfloat2 *nctemp1038;
nctemp1038=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1038->d[0]=Nx;
nctemp1038->d[1]=Ny;
nctemp1038->a=(float *)RunMalloc(sizeof(float)*nctemp1039);
Model->Eta1y=nctemp1038;
int nctemp1050=Nx;
nctemp1050=nctemp1050*Ny;
nctempfloat2 *nctemp1049;
nctemp1049=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1049->d[0]=Nx;
nctemp1049->d[1]=Ny;
nctemp1049->a=(float *)RunMalloc(sizeof(float)*nctemp1050);
Model->Eta2x=nctemp1049;
int nctemp1061=Nx;
nctemp1061=nctemp1061*Ny;
nctempfloat2 *nctemp1060;
nctemp1060=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1060->d[0]=Nx;
nctemp1060->d[1]=Ny;
nctemp1060->a=(float *)RunMalloc(sizeof(float)*nctemp1061);
Model->Eta2y=nctemp1060;
int nctemp1072=Nx;
nctemp1072=nctemp1072*Ny;
nctempfloat2 *nctemp1071;
nctemp1071=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1071->d[0]=Nx;
nctemp1071->d[1]=Ny;
nctemp1071->a=(float *)RunMalloc(sizeof(float)*nctemp1072);
Model->Nu1x=nctemp1071;
int nctemp1083=Nx;
nctemp1083=nctemp1083*Ny;
nctempfloat2 *nctemp1082;
nctemp1082=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1082->d[0]=Nx;
nctemp1082->d[1]=Ny;
nctemp1082->a=(float *)RunMalloc(sizeof(float)*nctemp1083);
Model->Nu1y=nctemp1082;
int nctemp1094=Nx;
nctemp1094=nctemp1094*Ny;
nctempfloat2 *nctemp1093;
nctemp1093=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1093->d[0]=Nx;
nctemp1093->d[1]=Ny;
nctemp1093->a=(float *)RunMalloc(sizeof(float)*nctemp1094);
Model->Nu2x=nctemp1093;
int nctemp1105=Nx;
nctemp1105=nctemp1105*Ny;
nctempfloat2 *nctemp1104;
nctemp1104=(nctempfloat2*)RunMalloc(sizeof(nctempfloat2));
nctemp1104->d[0]=Nx;
nctemp1104->d[1]=Ny;
nctemp1104->a=(float *)RunMalloc(sizeof(float)*nctemp1105);
Model->Nu2y=nctemp1104;
j =0;
int nctemp1114 = (j < Ny);
while(nctemp1114){
{
i =0;
int nctemp1122 = (i < Nx);
while(nctemp1122){
{
int nctemp1129=i;
nctemp1129=j*Model->Rho->d[0]+nctemp1129;
int nctemp1137=i;
nctemp1137=j*rho->d[0]+nctemp1137;
float nctemp1140 = 1.0 / rho->a[nctemp1137];
Model->Rho->a[nctemp1129] =nctemp1140;
int nctemp1144=i;
nctemp1144=j*Model->Mu->d[0]+nctemp1144;
int nctemp1154=i;
nctemp1154=j*rho->d[0]+nctemp1154;
int nctemp1158=i;
nctemp1158=j*vs->d[0]+nctemp1158;
float nctemp1161 = rho->a[nctemp1154] * vs->a[nctemp1158];
int nctemp1163=i;
nctemp1163=j*vs->d[0]+nctemp1163;
float nctemp1166 = nctemp1161 * vs->a[nctemp1163];
Model->Mu->a[nctemp1144] =nctemp1166;
int nctemp1170=i;
nctemp1170=j*Model->Lambda->d[0]+nctemp1170;
int nctemp1177=i;
nctemp1177=j*rho->d[0]+nctemp1177;
int nctemp1187=i;
nctemp1187=j*vp->d[0]+nctemp1187;
int nctemp1191=i;
nctemp1191=j*vp->d[0]+nctemp1191;
float nctemp1194 = vp->a[nctemp1187] * vp->a[nctemp1191];
int nctemp1203=i;
nctemp1203=j*vs->d[0]+nctemp1203;
float nctemp1206 = 2.0 * vs->a[nctemp1203];
int nctemp1208=i;
nctemp1208=j*vs->d[0]+nctemp1208;
float nctemp1211 = nctemp1206 * vs->a[nctemp1208];
float nctemp1212 = nctemp1194 - nctemp1211;
float nctemp1213 = rho->a[nctemp1177] * nctemp1212;
Model->Lambda->a[nctemp1170] =nctemp1213;
int nctemp1217=i;
nctemp1217=j*Model->Alpha1x->d[0]+nctemp1217;
Model->Alpha1x->a[nctemp1217] =0.0;
int nctemp1224=i;
nctemp1224=j*Model->Alpha1y->d[0]+nctemp1224;
Model->Alpha1y->a[nctemp1224] =0.0;
int nctemp1231=i;
nctemp1231=j*Model->Alpha2x->d[0]+nctemp1231;
Model->Alpha2x->a[nctemp1231] =0.0;
int nctemp1238=i;
nctemp1238=j*Model->Alpha2y->d[0]+nctemp1238;
Model->Alpha2y->a[nctemp1238] =0.0;
int nctemp1245=i;
nctemp1245=j*Model->Beta1x->d[0]+nctemp1245;
Model->Beta1x->a[nctemp1245] =0.0;
int nctemp1252=i;
nctemp1252=j*Model->Beta1y->d[0]+nctemp1252;
Model->Beta1y->a[nctemp1252] =0.0;
int nctemp1259=i;
nctemp1259=j*Model->Beta2x->d[0]+nctemp1259;
Model->Beta2x->a[nctemp1259] =0.0;
int nctemp1266=i;
nctemp1266=j*Model->Beta2y->d[0]+nctemp1266;
Model->Beta2y->a[nctemp1266] =0.0;
int nctemp1273=i;
nctemp1273=j*Model->Eta1x->d[0]+nctemp1273;
Model->Eta1x->a[nctemp1273] =0.0;
int nctemp1280=i;
nctemp1280=j*Model->Eta1y->d[0]+nctemp1280;
Model->Eta1y->a[nctemp1280] =0.0;
int nctemp1287=i;
nctemp1287=j*Model->Eta2x->d[0]+nctemp1287;
Model->Eta2x->a[nctemp1287] =0.0;
int nctemp1294=i;
nctemp1294=j*Model->Eta2y->d[0]+nctemp1294;
Model->Eta2y->a[nctemp1294] =0.0;
int nctemp1301=i;
nctemp1301=j*Model->Dlambdax->d[0]+nctemp1301;
int nctemp1305=i;
nctemp1305=j*Model->Lambda->d[0]+nctemp1305;
Model->Dlambdax->a[nctemp1301] =Model->Lambda->a[nctemp1305];
int nctemp1311=i;
nctemp1311=j*Model->Dlambday->d[0]+nctemp1311;
int nctemp1315=i;
nctemp1315=j*Model->Lambda->d[0]+nctemp1315;
Model->Dlambday->a[nctemp1311] =Model->Lambda->a[nctemp1315];
int nctemp1321=i;
nctemp1321=j*Model->Dmux->d[0]+nctemp1321;
int nctemp1325=i;
nctemp1325=j*Model->Mu->d[0]+nctemp1325;
Model->Dmux->a[nctemp1321] =Model->Mu->a[nctemp1325];
int nctemp1331=i;
nctemp1331=j*Model->Dmuy->d[0]+nctemp1331;
int nctemp1335=i;
nctemp1335=j*Model->Mu->d[0]+nctemp1335;
Model->Dmuy->a[nctemp1331] =Model->Mu->a[nctemp1335];
int nctemp1341=i;
nctemp1341=j*Model->Drhopx->d[0]+nctemp1341;
int nctemp1345=i;
nctemp1345=j*Model->Rho->d[0]+nctemp1345;
Model->Drhopx->a[nctemp1341] =Model->Rho->a[nctemp1345];
int nctemp1351=i;
nctemp1351=j*Model->Drhopy->d[0]+nctemp1351;
int nctemp1355=i;
nctemp1355=j*Model->Rho->d[0]+nctemp1355;
Model->Drhopy->a[nctemp1351] =Model->Rho->a[nctemp1355];
int nctemp1361=i;
nctemp1361=j*Model->Drhosx->d[0]+nctemp1361;
int nctemp1365=i;
nctemp1365=j*Model->Rho->d[0]+nctemp1365;
Model->Drhosx->a[nctemp1361] =Model->Rho->a[nctemp1365];
int nctemp1371=i;
nctemp1371=j*Model->Drhosy->d[0]+nctemp1371;
int nctemp1375=i;
nctemp1375=j*Model->Rho->d[0]+nctemp1375;
Model->Drhosy->a[nctemp1371] =Model->Rho->a[nctemp1375];
}
int nctemp1386 = i + 1;
i =nctemp1386;
int nctemp1387 = (i < Nx);
nctemp1122=nctemp1387;
}
}
int nctemp1399 = j + 1;
j =nctemp1399;
int nctemp1400 = (j < Ny);
nctemp1114=nctemp1400;
}
nctempfloat2* nctemp1405= Model->Qlx;
nctempfloat2* nctemp1408= Model->Qly;
nctempfloat2* nctemp1411= Model->Dlambdax;
nctempfloat2* nctemp1414= Model->Dlambday;
nctempfloat2* nctemp1417= Model->Alpha1x;
nctempfloat2* nctemp1420= Model->Alpha1y;
nctempfloat2* nctemp1423= Model->Alpha2x;
nctempfloat2* nctemp1426= Model->Alpha2y;
struct model* nctemp1429= Model;
int nctemp1431=Modelslscoeffs(nctemp1405,nctemp1408,nctemp1411,nctemp1414,nctemp1417,nctemp1420,nctemp1423,nctemp1426,nctemp1429);
nctempfloat2* nctemp1433= Model->Qmx;
nctempfloat2* nctemp1436= Model->Qmy;
nctempfloat2* nctemp1439= Model->Dmux;
nctempfloat2* nctemp1442= Model->Dmuy;
nctempfloat2* nctemp1445= Model->Beta1x;
nctempfloat2* nctemp1448= Model->Beta1y;
nctempfloat2* nctemp1451= Model->Beta2x;
nctempfloat2* nctemp1454= Model->Beta2y;
struct model* nctemp1457= Model;
int nctemp1459=Modelslscoeffs(nctemp1433,nctemp1436,nctemp1439,nctemp1442,nctemp1445,nctemp1448,nctemp1451,nctemp1454,nctemp1457);
nctempfloat2* nctemp1461= Model->Qpx;
nctempfloat2* nctemp1464= Model->Qpy;
nctempfloat2* nctemp1467= Model->Drhopx;
nctempfloat2* nctemp1470= Model->Drhopy;
nctempfloat2* nctemp1473= Model->Eta1x;
nctempfloat2* nctemp1476= Model->Eta1y;
nctempfloat2* nctemp1479= Model->Eta2x;
nctempfloat2* nctemp1482= Model->Eta2y;
struct model* nctemp1485= Model;
int nctemp1487=Modelslscoeffs(nctemp1461,nctemp1464,nctemp1467,nctemp1470,nctemp1473,nctemp1476,nctemp1479,nctemp1482,nctemp1485);
nctempfloat2* nctemp1489= Model->Qsx;
nctempfloat2* nctemp1492= Model->Qsy;
nctempfloat2* nctemp1495= Model->Drhosx;
nctempfloat2* nctemp1498= Model->Drhosy;
nctempfloat2* nctemp1501= Model->Nu1x;
nctempfloat2* nctemp1504= Model->Nu1y;
nctempfloat2* nctemp1507= Model->Nu2x;
nctempfloat2* nctemp1510= Model->Nu2y;
struct model* nctemp1513= Model;
int nctemp1515=Modelslscoeffs(nctemp1489,nctemp1492,nctemp1495,nctemp1498,nctemp1501,nctemp1504,nctemp1507,nctemp1510,nctemp1513);
return Model;
}
struct model* ModelNew (nctempfloat2 *vp,nctempfloat2 *vs,nctempfloat2 *rho,nctempfloat2 *Qlx,nctempfloat2 *Qly,nctempfloat2 *Qmx,nctempfloat2 *Qmy,nctempfloat2 *Qpx,nctempfloat2 *Qpy,nctempfloat2 *Qsx,nctempfloat2 *Qsy,float Dx,float Dt,float W0,int Nb,int Rheol)
{
struct model* m;
int nctemp1517 = (Rheol ==2);
if(nctemp1517)
{
nctempfloat2* nctemp1525= vp;
nctempfloat2* nctemp1528= vs;
nctempfloat2* nctemp1531= rho;
nctempfloat2* nctemp1534= Qlx;
nctempfloat2* nctemp1537= Qly;
nctempfloat2* nctemp1540= Qmx;
nctempfloat2* nctemp1543= Qmy;
nctempfloat2* nctemp1546= Qpx;
nctempfloat2* nctemp1549= Qpy;
nctempfloat2* nctemp1552= Qsx;
nctempfloat2* nctemp1555= Qsy;
float nctemp1558= Dx;
float nctemp1560= Dt;
float nctemp1562= W0;
int nctemp1564= Nb;
struct model* nctemp1566=Modelsls(nctemp1525,nctemp1528,nctemp1531,nctemp1534,nctemp1537,nctemp1540,nctemp1543,nctemp1546,nctemp1549,nctemp1552,nctemp1555,nctemp1558,nctemp1560,nctemp1562,nctemp1564);
m =nctemp1566;
}
else{
int nctemp1568= 4;
struct nctempchar1 *nctemp1572;
static struct nctempchar1 nctemp1573 = {{ 18}, (char*)"Unknown Q-model\n\0"};
nctemp1572=&nctemp1573;
nctempchar1* nctemp1570= nctemp1572;
int nctemp1574=LibePuts(nctemp1568,nctemp1570);
int nctemp1576= 4;
int nctemp1578=LibeFlush(nctemp1576);
int nctemp1580=LibeExit();
}
return m;
}
float ModelStability (struct model* Model)
{
int nx;
int ny;
int i;
int j;
float vp;
float stab;
nx =Model->Nx;
ny =Model->Ny;
j =0;
int nctemp1594 = (j < ny);
while(nctemp1594){
{
i =0;
int nctemp1602 = (i < nx);
while(nctemp1602){
{
int nctemp1617=i;
nctemp1617=j*Model->Lambda->d[0]+nctemp1617;
int nctemp1625=i;
nctemp1625=j*Model->Mu->d[0]+nctemp1625;
float nctemp1628 = 2.0 * Model->Mu->a[nctemp1625];
float nctemp1629 = Model->Lambda->a[nctemp1617] + nctemp1628;
int nctemp1631=i;
nctemp1631=j*Model->Rho->d[0]+nctemp1631;
float nctemp1634 = nctemp1629 / Model->Rho->a[nctemp1631];
float nctemp1610= nctemp1634;
float nctemp1635=LibeSqrt(nctemp1610);
vp =nctemp1635;
float nctemp1647 = vp * Model->Dt;
float nctemp1649 = nctemp1647 / Model->Dx;
stab =nctemp1649;
float nctemp1658= 2.0;
float nctemp1660=LibeSqrt(nctemp1658);
float nctemp1661 = 1.0 / nctemp1660;
int nctemp1650 = (stab > nctemp1661);
if(nctemp1650)
{
int nctemp1663= 4;
struct nctempchar1 *nctemp1667;
static struct nctempchar1 nctemp1668 = {{ 28}, (char*)"Stability index too large! \0"};
nctemp1667=&nctemp1668;
nctempchar1* nctemp1665= nctemp1667;
int nctemp1669=LibePuts(nctemp1663,nctemp1665);
int nctemp1671= 4;
float nctemp1673= stab;
struct nctempchar1 *nctemp1677;
static struct nctempchar1 nctemp1678 = {{ 2}, (char*)"g\0"};
nctemp1677=&nctemp1678;
nctempchar1* nctemp1675= nctemp1677;
int nctemp1679=LibePutf(nctemp1671,nctemp1673,nctemp1675);
int nctemp1681= 4;
struct nctempchar1 *nctemp1685;
static struct nctempchar1 nctemp1686 = {{ 3}, (char*)"\n\0"};
nctemp1685=&nctemp1686;
nctempchar1* nctemp1683= nctemp1685;
int nctemp1687=LibePuts(nctemp1681,nctemp1683);
int nctemp1689= 4;
struct nctempchar1 *nctemp1693;
static struct nctempchar1 nctemp1694 = {{ 7}, (char*)"vp: \n\0"};
nctemp1693=&nctemp1694;
nctempchar1* nctemp1691= nctemp1693;
int nctemp1695=LibePuts(nctemp1689,nctemp1691);
int nctemp1697= 4;
float nctemp1699= vp;
struct nctempchar1 *nctemp1703;
static struct nctempchar1 nctemp1704 = {{ 2}, (char*)"g\0"};
nctemp1703=&nctemp1704;
nctempchar1* nctemp1701= nctemp1703;
int nctemp1705=LibePutf(nctemp1697,nctemp1699,nctemp1701);
int nctemp1707= 4;
struct nctempchar1 *nctemp1711;
static struct nctempchar1 nctemp1712 = {{ 3}, (char*)"\n\0"};
nctemp1711=&nctemp1712;
nctempchar1* nctemp1709= nctemp1711;
int nctemp1713=LibePuts(nctemp1707,nctemp1709);
int nctemp1715= 4;
struct nctempchar1 *nctemp1719;
static struct nctempchar1 nctemp1720 = {{ 7}, (char*)"dt: \n\0"};
nctemp1719=&nctemp1720;
nctempchar1* nctemp1717= nctemp1719;
int nctemp1721=LibePuts(nctemp1715,nctemp1717);
int nctemp1723= 4;
float nctemp1725= Model->Dt;
struct nctempchar1 *nctemp1729;
static struct nctempchar1 nctemp1730 = {{ 2}, (char*)"g\0"};
nctemp1729=&nctemp1730;
nctempchar1* nctemp1727= nctemp1729;
int nctemp1731=LibePutf(nctemp1723,nctemp1725,nctemp1727);
int nctemp1733= 4;
struct nctempchar1 *nctemp1737;
static struct nctempchar1 nctemp1738 = {{ 3}, (char*)"\n\0"};
nctemp1737=&nctemp1738;
nctempchar1* nctemp1735= nctemp1737;
int nctemp1739=LibePuts(nctemp1733,nctemp1735);
int nctemp1741= 4;
struct nctempchar1 *nctemp1745;
static struct nctempchar1 nctemp1746 = {{ 7}, (char*)"dx: \n\0"};
nctemp1745=&nctemp1746;
nctempchar1* nctemp1743= nctemp1745;
int nctemp1747=LibePuts(nctemp1741,nctemp1743);
int nctemp1749= 4;
float nctemp1751= Model->Dx;
struct nctempchar1 *nctemp1755;
static struct nctempchar1 nctemp1756 = {{ 2}, (char*)"g\0"};
nctemp1755=&nctemp1756;
nctempchar1* nctemp1753= nctemp1755;
int nctemp1757=LibePutf(nctemp1749,nctemp1751,nctemp1753);
int nctemp1759= 4;
struct nctempchar1 *nctemp1763;
static struct nctempchar1 nctemp1764 = {{ 3}, (char*)"\n\0"};
nctemp1763=&nctemp1764;
nctempchar1* nctemp1761= nctemp1763;
int nctemp1765=LibePuts(nctemp1759,nctemp1761);
int nctemp1767= 4;
int nctemp1769=LibeFlush(nctemp1767);
}
}
int nctemp1778 = i + 1;
i =nctemp1778;
int nctemp1779 = (i < nx);
nctemp1602=nctemp1779;
}
}
int nctemp1791 = j + 1;
j =nctemp1791;
int nctemp1792 = (j < ny);
nctemp1594=nctemp1792;
}
return stab;
}
